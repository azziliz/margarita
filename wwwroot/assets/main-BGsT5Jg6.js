import{_ as h,d as c,c as o,o as n,a,b as t,e as d,t as l,f as g,F as u,r as p,g as v,h as b}from"./_plugin-vue_export-helper-BbTsJ6z5.js";const k="/usfr.jpg",f="/0.jpg",w="/fr.svg",C="/be.svg",T="/ch.svg",m="/ca.svg",_="/gb.svg",I="/us.svg",x="/au.svg",S=c({data(){return{state:"homepage",loading:!0,getmenuresponse:null,getinvoiceresponse:null,getuserresponse:null,postorderresponse:null,orderimpl:{}}},computed:{customerId(){return new URLSearchParams(window.location.search).get("customerId")}},async created(){await this.getMeCust()},methods:{async getMeCust(){this.loading=!0,this.getuserresponse=null;var e=await fetch("api/users/"+this.customerId);e.ok&&(this.getuserresponse=await e.json(),this.loading=!1)},async getMenu(){this.getmenuresponse=null,this.orderimpl={};var e=await fetch("api/menu");e.ok&&(this.getmenuresponse=await e.json(),this.getmenuresponse.forEach(s=>{this.orderimpl[s.id]=0}))},async getMyInvoices(){this.getinvoiceresponse=null;var e=await fetch("api/invoices/mine?cust="+this.customerId);e.ok&&(this.getinvoiceresponse=await e.json())},async goToOrder(){await this.getMenu(),this.state="order"},async goToOrderSent(){this.state="ordersent"},async goToInvoice(){await this.getMyInvoices(),this.state="invoice"},async goToHome(){this.state="homepage"},async goToLang(){this.state="lang"},async goToFr(){this.state="homepage"},async goToEn(){this.state="homepage"},async postOrder(){this.postorderresponse=null;var e=await fetch("api/orders?cust="+this.customerId,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.entries(this.orderimpl).map(s=>({menuId:s[0],amount:s[1]})))});e.ok&&await this.goToOrderSent()},formatDate(e){const s=new Date(e);return s.toLocaleDateString()+" à "+s.toLocaleTimeString()}}}),O={key:0,class:"margscreen"},$={key:0,class:"loading"},L={key:1,class:"content"},j={key:1,class:"margscreen"},F={class:"content"},M={key:2,class:"margscreen"},D={key:0,class:"content"},N=["onClick"],V={key:0},E=["onClick"],A=["onClick"],P=["onClick"],B={style:{height:"35px"}},H={key:0,style:{"font-size":"12px","font-style":"italic"}},U={key:1},q={key:3,class:"margscreen"},R={key:0,class:"content"},z=["datetime"],J={style:{"text-align":"right"}},K={style:{"text-align":"right"}},Q={style:{"text-align":"right"}},G={style:{"text-align":"right"}},W={style:{"text-align":"right"}},X={key:4,class:"margscreen"},Y={class:"content"};function Z(e,s,y,nt,it,rt){return n(),o(u,null,[e.state==="homepage"?(n(),o("div",O,[e.loading?(n(),o("div",$," Chargement en cours, merci de patientier. ")):e.getuserresponse?(n(),o("div",L,[t("div",{style:{position:"absolute",right:"0",top:"0"},onClick:s[0]||(s[0]=async()=>await this.goToLang())},s[9]||(s[9]=[t("img",{src:k,alt:"Lang",style:{width:"60px",padding:"0.5rem"}},null,-1)])),s[10]||(s[10]=t("h2",null,[d("Margarita 2025"),t("br"),d("Viry-Châtillon France")],-1)),s[11]||(s[11]=t("img",{src:f,alt:"Margarita 2025 Logo",class:"marglogo"},null,-1)),t("h2",null,"Équipe "+l(e.getuserresponse.team.name),1),s[12]||(s[12]=t("br",null,null,-1)),t("div",null,[t("button",{onClick:s[1]||(s[1]=async()=>await this.goToOrder())},"Commander"),t("button",{onClick:s[2]||(s[2]=async()=>await this.goToInvoice())},"Voir historique")])])):a("",!0)])):a("",!0),e.state==="lang"?(n(),o("div",j,[t("div",F,[t("div",{onClick:s[3]||(s[3]=async()=>await this.goToFr()),style:{width:"280px",padding:"10px",border:"1px solid black","border-radius":"5px",margin:"0 auto 20px auto"}},s[13]||(s[13]=[g('<img src="'+w+'" alt="France" style="width:80px;aspect-ratio:1.333;float:left;" data-v-b564c952><img src="'+C+'" alt="Belgique" style="width:80px;aspect-ratio:1.333;float:right;" data-v-b564c952><h2 style="clear:both;" data-v-b564c952>Français</h2><img src="'+T+'" alt="Suisse" style="width:80px;aspect-ratio:1.333;float:left;" data-v-b564c952><img src="'+m+'" alt="Canada" style="width:80px;aspect-ratio:1.333;float:right;" data-v-b564c952><div style="clear:both;" data-v-b564c952></div>',6)])),t("div",{onClick:s[4]||(s[4]=async()=>await this.goToEn()),style:{width:"280px",padding:"10px",border:"1px solid black","border-radius":"5px",margin:"0 auto 20px auto"}},s[14]||(s[14]=[g('<img src="'+_+'" alt="UK" style="width:80px;aspect-ratio:1.333;float:left;" data-v-b564c952><img src="'+I+'" alt="US" style="width:80px;aspect-ratio:1.333;float:right;" data-v-b564c952><h2 style="clear:both;" data-v-b564c952>English</h2><img src="'+x+'" alt="Australia" style="width:80px;aspect-ratio:1.333;float:left;" data-v-b564c952><img src="'+m+'" alt="Canada" style="width:80px;aspect-ratio:1.333;float:right;" data-v-b564c952><div style="clear:both;" data-v-b564c952></div>',6)]))])])):a("",!0),e.state==="order"?(n(),o("div",M,[e.getmenuresponse?(n(),o("div",D,[s[16]||(s[16]=t("h2",null,"Commande",-1)),s[17]||(s[17]=t("br",null,null,-1)),t("table",null,[s[15]||(s[15]=t("thead",null,[t("tr",null,[t("th",null,[t("span",{style:{visibility:"hidden"}},"99")]),t("th",null,"Nom"),t("th",null,"Prix"),t("th",null,[t("span",{style:{visibility:"hidden"}},"❌")])])],-1)),t("tbody",null,[(n(!0),o(u,null,p(e.getmenuresponse,i=>(n(),o("tr",{key:i.id},[t("td",{onClick:r=>e.orderimpl[i.id]++},[e.orderimpl[i.id]>0?(n(),o("span",V,l(e.orderimpl[i.id]),1)):a("",!0)],8,N),t("td",{onClick:r=>e.orderimpl[i.id]++},l(i.name),9,E),t("td",{onClick:r=>e.orderimpl[i.id]++},l(i.price)+" €",9,A),t("td",null,[e.orderimpl[i.id]>0?(n(),o("span",{key:0,onClick:r=>e.orderimpl[i.id]--},"❌",8,P)):a("",!0)])]))),128))])]),s[18]||(s[18]=t("br",null,null,-1)),t("div",B,[Object.values(e.orderimpl).reduce((i,r)=>i+r,0)<=0?(n(),o("span",H,"Tapez les lignes pour commander")):(n(),o("span",U,[t("button",{onClick:s[5]||(s[5]=async()=>await this.postOrder())},"Envoyer")]))]),s[19]||(s[19]=t("br",null,null,-1)),t("div",null,[t("button",{onClick:s[6]||(s[6]=async()=>await this.goToHome())},"Annuler")])])):a("",!0)])):a("",!0),e.state==="invoice"?(n(),o("div",q,[e.getinvoiceresponse?(n(),o("div",R,[s[24]||(s[24]=t("h2",null,"Factures",-1)),s[25]||(s[25]=t("br",null,null,-1)),(n(!0),o(u,null,p(e.getinvoiceresponse,i=>(n(),o("div",{key:i.id},[t("div",null,[s[20]||(s[20]=d("Le ")),t("time",{datetime:i.createdDate},l(e.formatDate(i.createdDate)),9,z)]),t("table",null,[s[22]||(s[22]=t("thead",null,[t("tr",null,[t("th",{class:"noborder"},[t("span",{style:{visibility:"hidden"}},"9999999999999")]),t("th",null,"Qté"),t("th",null,"PU"),t("th",null,"Tot")])],-1)),t("tbody",null,[(n(!0),o(u,null,p(i.invoiceItems,r=>(n(),o("tr",{key:r.id},[t("td",J,l(r.menu.name),1),t("td",K,l(r.amount),1),t("td",Q,l(r.menu.price),1),t("td",G,l(r.amount*r.menu.price),1)]))),128))]),t("thead",null,[t("tr",null,[s[21]||(s[21]=t("th",{class:"noborder",colspan:"3",style:{"text-align":"right"}},"Total",-1)),t("th",W,l(i.total),1)])])]),s[23]||(s[23]=t("br",null,null,-1))]))),128)),t("div",null,[t("button",{onClick:s[7]||(s[7]=async()=>await this.goToHome())},"Retour")])])):a("",!0)])):a("",!0),e.state==="ordersent"?(n(),o("div",X,[t("div",Y,[s[26]||(s[26]=t("h2",null,[d("Commande envoyée au bar"),t("br"),d("avec succès")],-1)),s[27]||(s[27]=t("br",null,null,-1)),t("div",null,[t("button",{onClick:s[8]||(s[8]=async()=>await this.goToHome())},"Retour")])])])):a("",!0)],64)}const tt=h(S,[["render",Z],["__scopeId","data-v-b564c952"]]),st={class:"wrapper"},et={__name:"CustApp",setup(e){return(s,y)=>(n(),o("main",null,[t("div",st,[v(tt)])]))}},ot=h(et,[["__scopeId","data-v-822f4d4e"]]);b(ot).mount("#app");
