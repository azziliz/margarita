import{_ as p,d as h,c as o,o as n,a as l,b as e,t as a,F as d,r as u,e as g,g as y,h as f}from"./_plugin-vue_export-helper-BbTsJ6z5.js";const w=h({data(){return{state:"homepage",loading:!0,getmenuresponse:null,gettodoresponse:null,getinvoiceresponse:null,getuserresponse:null,getstaffresponse:null,postorderresponse:null,orderimpl:{},orderIdInProgress:null}},computed:{customerId(){return new URLSearchParams(window.location.search).get("customerId")},staffId(){return new URLSearchParams(window.location.search).get("staffId")}},async created(){await this.getMeAdm()},methods:{async getMeAdm(){this.loading=!0,this.getstaffresponse=null;var s=await fetch("api/staff/"+this.staffId);s.ok&&(this.getstaffresponse=await s.json(),this.loading=!1)},async getMeCust(){this.loading=!0,this.getuserresponse=null;var s=await fetch("api/users/"+this.customerId);s.ok&&(this.getuserresponse=await s.json(),this.loading=!1)},async getMenu(){this.getmenuresponse=null,this.orderimpl={};var s=await fetch("api/menu");s.ok&&(this.getmenuresponse=await s.json(),this.getmenuresponse.forEach(t=>{this.orderimpl[t.id]=0}))},async getTodo(){this.gettodoresponse=null;var s=await fetch("api/orders/todo?staff="+this.staffId);s.ok&&(this.gettodoresponse=await s.json())},async goToOrder(){await this.getMenu(),this.state="order"},async goToOrderSent(){this.state="ordersent"},async goToInvoice(){await this.getMyInvoices(),this.state="invoice"},async goToHome(){this.state="homepage"},async goToTodo(){await this.getTodo(),this.state="orderstodo"},async goToTakeInCharge(s){this.orderIdInProgress=s,this.state="orderinprogress"},async postOrder(){this.postorderresponse=null;var s=await fetch("api/orders?cust="+this.customerId,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.entries(this.orderimpl).map(t=>({menuId:t[0],amount:t[1]})))});s.ok&&await this.goToOrderSent()},formatDate(s){const t=new Date(s);return t.toLocaleDateString()+" à "+t.toLocaleTimeString()},formatTime(s){return new Date(s).toLocaleTimeString()}}}),k={key:0,class:"margscreen"},b={key:0,class:"loading"},v={key:1,class:"content"},T={key:1,class:"margscreen"},C={key:0,class:"content"},c=["onClick"],I={style:{"font-weight":"bold","font-size":"16px"}},S=["datetime"],D={style:{width:"34px"}},O={style:{width:"101px"}},P={key:2,class:"margscreen"},B={key:0,class:"content"},L=["datetime"],M={style:{"text-align":"right"}},R={style:{"text-align":"right"}},j={style:{"text-align":"right"}},x={style:{"text-align":"right"}},A={style:{"text-align":"right"}},$={key:3,class:"margscreen"},N={class:"content"};function V(s,t,m,z,G,Q){return n(),o(d,null,[s.state==="homepage"?(n(),o("div",k,[s.loading?(n(),o("div",b," Chargement en cours, merci de patientier. ")):s.getstaffresponse?(n(),o("div",v,[t[10]||(t[10]=e("h2",null,"Margarita 2025",-1)),t[11]||(t[11]=e("h2",null,"SERVICE",-1)),e("h2",null,a(s.getstaffresponse.name),1),t[12]||(t[12]=e("br",null,null,-1)),t[13]||(t[13]=e("h3",null,"Commandes",-1)),e("div",null,[e("button",{onClick:t[0]||(t[0]=async()=>await this.goToTodo())},"À traiter"),e("button",{onClick:t[1]||(t[1]=async()=>await this.goToOrder())},"Immédiates"),e("button",{onClick:t[2]||(t[2]=async()=>await this.goToOrder())},"Paiement"),e("button",{onClick:t[3]||(t[3]=async()=>await this.goToOrder())},"Correction")]),t[14]||(t[14]=e("br",null,null,-1)),t[15]||(t[15]=e("h3",null,"Équipes",-1)),e("div",null,[e("button",{onClick:t[4]||(t[4]=async()=>await this.goToInvoice())},"Afficher QR Code"),e("button",{onClick:t[5]||(t[5]=async()=>await this.goToInvoice())},"Générer nouveau")]),t[16]||(t[16]=e("br",null,null,-1)),t[17]||(t[17]=e("h3",null,"Bar",-1)),e("div",null,[e("button",{onClick:t[6]||(t[6]=async()=>await this.goToInvoice())},"Gérer la carte")])])):l("",!0)])):l("",!0),s.state==="orderstodo"?(n(),o("div",T,[s.gettodoresponse?(n(),o("div",C,[t[19]||(t[19]=e("h2",null,"Commandes à traiter",-1)),t[20]||(t[20]=e("br",null,null,-1)),(n(!0),o(d,null,u(s.gettodoresponse,r=>(n(),o("div",{key:r.id,onClick:async()=>await this.goToTakeInCharge(r.id),style:{border:"0","background-color":"white","border-radius":"5px",padding:"10px",margin:"0 auto 20px auto","max-width":"400px"}},[e("div",null,[e("span",I,a(r.customer.team.name),1),t[18]||(t[18]=g(" - ")),e("time",{datetime:r.createdDate,style:{"font-style":"italic","font-size":"13px"}},a(s.formatTime(r.createdDate)),9,S)]),e("table",null,[e("tbody",null,[(n(!0),o(d,null,u(r.orderItems,i=>(n(),o("tr",{key:i.id},[e("td",D,a(i.amount),1),e("td",O,a(i.menu.name),1)]))),128))])])],8,c))),128)),e("div",null,[e("button",{onClick:t[7]||(t[7]=async()=>await this.goToHome())},"Retour")])])):l("",!0)])):l("",!0),s.state==="invoice"?(n(),o("div",P,[s.getinvoiceresponse?(n(),o("div",B,[t[25]||(t[25]=e("h2",null,"Factures",-1)),t[26]||(t[26]=e("br",null,null,-1)),(n(!0),o(d,null,u(s.getinvoiceresponse,r=>(n(),o("div",{key:r.id},[e("div",null,[t[21]||(t[21]=g("Le ")),e("time",{datetime:r.createdDate},a(s.formatDate(r.createdDate)),9,L)]),e("table",null,[t[23]||(t[23]=e("thead",null,[e("tr",null,[e("th",{class:"noborder"},[e("span",{style:{visibility:"hidden"}},"9999999999999")]),e("th",null,"Qté"),e("th",null,"PU"),e("th",null,"Tot")])],-1)),e("tbody",null,[(n(!0),o(d,null,u(r.invoiceItems,i=>(n(),o("tr",{key:i.id},[e("td",M,a(i.menu.name),1),e("td",R,a(i.amount),1),e("td",j,a(i.menu.price),1),e("td",x,a(i.amount*i.menu.price),1)]))),128))]),e("thead",null,[e("tr",null,[t[22]||(t[22]=e("th",{class:"noborder",colspan:"3",style:{"text-align":"right"}},"Total",-1)),e("th",A,a(r.total),1)])])]),t[24]||(t[24]=e("br",null,null,-1))]))),128)),e("div",null,[e("button",{onClick:t[8]||(t[8]=async()=>await this.goToHome())},"Retour")])])):l("",!0)])):l("",!0),s.state==="ordersent"?(n(),o("div",$,[e("div",N,[t[27]||(t[27]=e("h2",null,[g("Commande envoyée au bar"),e("br"),g("avec succès")],-1)),t[28]||(t[28]=e("br",null,null,-1)),e("div",null,[e("button",{onClick:t[9]||(t[9]=async()=>await this.goToHome())},"Retour")])])])):l("",!0)],64)}const E=p(w,[["render",V],["__scopeId","data-v-3a21ac38"]]),H={class:"wrapper"},F={__name:"BarApp",setup(s){return(t,m)=>(n(),o("main",null,[e("div",H,[y(E)])]))}},U=p(F,[["__scopeId","data-v-55f20e60"]]);f(U).mount("#app");
